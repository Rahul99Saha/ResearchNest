{"ast":null,"code":"var _jsxFileName = \"/Users/snigdhapani/Documents/SSDLab/Mid/ResearchNest/Frontend/src/components/Dashboard/StudentDashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useContext } from 'react';\nimport API from '../../api.js';\nimport ProgressTree from '../Progress/ProgressTree.js';\nimport { AuthContext } from '../../contexts/AuthContext.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function StudentDashboard() {\n  _s();\n  const [progress, setProgress] = useState(null);\n  const {\n    user\n  } = useContext(AuthContext);\n  useEffect(() => {\n    API.get('/progress/me').then(r => setProgress(r.data)).catch(() => {});\n  }, []);\n  const onToggle = async (nodeId, newStatus) => {\n    const old = JSON.stringify(progress);\n    function mutateNode(obj) {\n      for (const ms of obj.milestones) {\n        if (ms._id === nodeId) {\n          ms.status = newStatus;\n          return true;\n        }\n        for (const st of ms.stages) {\n          if (st._id === nodeId) {\n            st.status = newStatus;\n            return true;\n          }\n          for (const t of st.tasks) {\n            if (t._id === nodeId) {\n              t.status = newStatus;\n              return true;\n            }\n            for (const s of t.subtasks) {\n              if (s._id === nodeId) {\n                s.status = newStatus;\n                return true;\n              }\n            }\n          }\n        }\n      }\n      return false;\n    }\n    const copy = JSON.parse(JSON.stringify(progress));\n    if (mutateNode(copy)) {\n      setProgress(copy);\n    }\n    try {\n      const res = await API.patch(`/progress/node/${nodeId}`, {\n        status: newStatus\n      });\n      setProgress(res.data);\n    } catch (err) {\n      alert('Update failed');\n      setProgress(JSON.parse(old));\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: 16\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [\"Welcome \", user === null || user === void 0 ? void 0 : user.name]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ProgressTree, {\n      data: progress,\n      onToggle: onToggle\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 21,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 19,\n    columnNumber: 5\n  }, this);\n}\n_s(StudentDashboard, \"hgYAFd9OAQ4JfW9A+ifsTxCLNnA=\");\n_c = StudentDashboard;\nvar _c;\n$RefreshReg$(_c, \"StudentDashboard\");","map":{"version":3,"names":["React","useState","useEffect","useContext","API","ProgressTree","AuthContext","jsxDEV","_jsxDEV","StudentDashboard","_s","progress","setProgress","user","get","then","r","data","catch","onToggle","nodeId","newStatus","old","JSON","stringify","mutateNode","obj","ms","milestones","_id","status","st","stages","t","tasks","s","subtasks","copy","parse","res","patch","err","alert","style","padding","children","name","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/snigdhapani/Documents/SSDLab/Mid/ResearchNest/Frontend/src/components/Dashboard/StudentDashboard.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport API from '../../api.js';\nimport ProgressTree from '../Progress/ProgressTree.js';\nimport { AuthContext } from '../../contexts/AuthContext.js';\nexport default function StudentDashboard(){\n  const [progress,setProgress]=useState(null);\n  const { user } = useContext(AuthContext);\n  useEffect(()=>{ API.get('/progress/me').then(r=>setProgress(r.data)).catch(()=>{}); },[]);\n  const onToggle = async (nodeId, newStatus) => {\n    const old = JSON.stringify(progress);\n    function mutateNode(obj){\n      for(const ms of obj.milestones){ if(ms._id===nodeId){ ms.status=newStatus; return true; } for(const st of ms.stages){ if(st._id===nodeId){ st.status=newStatus; return true;} for(const t of st.tasks){ if(t._id===nodeId){ t.status=newStatus; return true;} for(const s of t.subtasks){ if(s._id===nodeId){ s.status=newStatus; return true; } } } } }\n      return false;\n    }\n    const copy = JSON.parse(JSON.stringify(progress)); if(mutateNode(copy)){ setProgress(copy); }\n    try{ const res = await API.patch(`/progress/node/${nodeId}`, { status: newStatus }); setProgress(res.data); } catch(err){ alert('Update failed'); setProgress(JSON.parse(old)); }\n  };\n  return (\n    <div style={{ padding: 16 }}>\n      <h2>Welcome {user?.name}</h2>\n      <ProgressTree data={progress} onToggle={onToggle} />\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}